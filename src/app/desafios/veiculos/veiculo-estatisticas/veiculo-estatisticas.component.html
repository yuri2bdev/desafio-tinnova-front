<div class="estatisticas-container">
  <div class="header">
    <div class="header-left">
      <app-home-button></app-home-button>
      <h2 class="estatisticas-title">üìä Estat√≠sticas de Ve√≠culos</h2>
    </div>
  </div>

  <div class="loading-container" *ngIf="carregando">
    <mat-spinner diameter="40"></mat-spinner>
    <span>Carregando estat√≠sticas...</span>
  </div>

  <div class="estatisticas-content" *ngIf="!carregando">
    <!-- Cards de resumo -->
    <div class="resumo-cards">
      <mat-card class="resumo-card total-card">
        <mat-card-content>
          <div class="card-icon">üöó</div>
          <div class="card-info">
            <div class="card-title">Total de Ve√≠culos</div>
            <div class="card-value">{{ totalVeiculos }}</div>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="resumo-card vendidos-card">
        <mat-card-content>
          <div class="card-icon">‚úÖ</div>
          <div class="card-info">
            <div class="card-title">Ve√≠culos Vendidos</div>
            <div class="card-value">{{ totalVendidos }}</div>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="resumo-card nao-vendidos-card">
        <mat-card-content>
          <div class="card-icon">üîÑ</div>
          <div class="card-info">
            <div class="card-title">Ve√≠culos Dispon√≠veis</div>
            <div class="card-value">{{ totalNaoVendidos }}</div>
          </div>
        </mat-card-content>
      </mat-card>
    </div>

    <!-- Dados em tabelas ao inv√©s de gr√°ficos -->
    <div class="graficos-container">
      <mat-card class="grafico-card">
        <mat-card-header>
          <mat-card-title>Ve√≠culos por D√©cada</mat-card-title>
          <mat-card-subtitle>Distribui√ß√£o dos ve√≠culos por d√©cada de fabrica√ß√£o</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <div class="tabela-wrapper">
            <table class="estatisticas-tabela">
              <thead>
                <tr>
                  <th>D√©cada</th>
                  <th>Quantidade</th>
                  <th>Porcentagem</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let label of decadasChartData.labels; let i = index">
                  <td>{{ label }}</td>
                  <td>{{ decadasChartData.datasets[0].data[i] }}</td>
                  <td>{{ (decadasChartData.datasets[0].data[i] / totalVeiculos * 100).toFixed(1) }}%</td>
                </tr>
              </tbody>
            </table>
          </div>
        </mat-card-content>
      </mat-card>

      <mat-card class="grafico-card">
        <mat-card-header>
          <mat-card-title>Ve√≠culos por Marca</mat-card-title>
          <mat-card-subtitle>Top 10 marcas com mais ve√≠culos</mat-card-subtitle>
        </mat-card-header>
        <mat-card-content>
          <div class="tabela-wrapper">
            <table class="estatisticas-tabela">
              <thead>
                <tr>
                  <th>Marca</th>
                  <th>Quantidade</th>
                  <th>Porcentagem</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let label of marcasChartData.labels; let i = index">
                  <td>{{ label }}</td>
                  <td>{{ marcasChartData.datasets[0].data[i] }}</td>
                  <td>{{ (marcasChartData.datasets[0].data[i] / totalVeiculos * 100).toFixed(1) }}%</td>
                </tr>
              </tbody>
            </table>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>

  <div class="sem-dados" *ngIf="!carregando && totalVeiculos === 0">
    <mat-icon>insert_chart</mat-icon>
    <p>N√£o h√° dados suficientes para exibir estat√≠sticas.</p>
    <p class="info-secundaria">Cadastre ve√≠culos para visualizar os gr√°ficos.</p>
  </div>
</div> 